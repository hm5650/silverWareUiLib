local UILib = {}
UILib.__index = UILib

function UILib.new(title)
    local self = setmetatable({}, UILib)

    local gui = Instance.new("ScreenGui", game:GetService("CoreGui"))
    gui.ResetOnSpawn = false

    local main = Instance.new("Frame", gui)
    main.Size = UDim2.new(0, 160, 0, 110)
    main.Position = UDim2.new(0.5, -80, 0.5, -55)
    main.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
    main.BackgroundTransparency = 0.2
    main.BorderSizePixel = 0
    main.Active = true
    main.Draggable = true
    main.ClipsDescendants = true

    local corner = Instance.new("UICorner", main)
    corner.CornerRadius = UDim.new(0, 10)

    local minimize = Instance.new("TextButton", main)
    minimize.Size = UDim2.new(0, 20, 0, 20)
    minimize.Position = UDim2.new(0, 0, 0, 0)
    minimize.Text = "▼"
    minimize.BackgroundColor3 = Color3.fromRGB(80, 80, 80)
    minimize.TextColor3 = Color3.fromRGB(255, 150, 255)
    Instance.new("UICorner", minimize).CornerRadius = UDim.new(0, 10)

    local scroll = Instance.new("ScrollingFrame", main)
    scroll.Size = UDim2.new(1, 0, 1, -22)
    scroll.Position = UDim2.new(0, 0, 0, 22)
    scroll.CanvasSize = UDim2.new(0, 0, 0, 0)
    scroll.ScrollBarThickness = 6
    scroll.BackgroundTransparency = 1
    scroll.AutomaticCanvasSize = Enum.AutomaticSize.Y

    local list = Instance.new("UIListLayout", scroll)
    list.Padding = UDim.new(0, 6)
    list.SortOrder = Enum.SortOrder.LayoutOrder

    self.gui = gui
    self.frame = main
    self.scroll = scroll
    self.minimized = false

    local tweenService = game:GetService("TweenService")
    
    minimize.MouseButton1Click:Connect(function()
        self.minimized = not self.minimized
        local tweenInfo = TweenInfo.new(0.5, Enum.EasingStyle.Quad, Enum.EasingDirection.Out)
        local targetSize = self.minimized and UDim2.new(0, 160, 0, 22) or UDim2.new(0, 160, 0, 110)
        local tween = tweenService:Create(main, tweenInfo, {Size = targetSize})
        tween:Play()
        minimize.Text = self.minimized and "▲" or "▼"
    end)

    return self
end

function UILib:addBtn(name, callback)
    local btn = Instance.new("TextButton", self.scroll)
    btn.Size = UDim2.new(1, -12, 0, 25)
    btn.Text = name
    btn.BackgroundColor3 = Color3.fromRGB(90, 90, 90)
    btn.TextColor3 = Color3.fromRGB(255, 150, 255)
    btn.Font = Enum.Font.SourceSans
    btn.TextSize = 14
    
    local corner = Instance.new("UICorner", btn)
    corner.CornerRadius = UDim.new(0, 10)
    
    btn.MouseButton1Click:Connect(function()
        callback()
    end)
    
    return btn
end

function UILib:addToggle(name, callback)
    local toggled = false
    local btn = Instance.new("TextButton", self.scroll)
    btn.Size = UDim2.new(1, -12, 0, 25)
    btn.Text = "Enable " .. name
    btn.BackgroundColor3 = Color3.fromRGB(90, 90, 90)
    btn.TextColor3 = Color3.fromRGB(255, 150, 255)
    btn.Font = Enum.Font.SourceSans
    btn.TextSize = 14
    
    local corner = Instance.new("UICorner", btn)
    corner.CornerRadius = UDim.new(0, 10)

    btn.MouseButton1Click:Connect(function()
        toggled = not toggled
        btn.Text = (toggled and "Disable " or "Enable ") .. name
        callback(toggled)
    end)
    
    return btn
end

function UILib:addTextbox(placeholder, callback)
    local box = Instance.new("TextBox", self.scroll)
    box.Size = UDim2.new(1, -12, 0, 25)
    box.PlaceholderText = placeholder
    box.Text = ""
    box.BackgroundColor3 = Color3.fromRGB(70, 70, 70)
    box.TextColor3 = Color3.fromRGB(255, 255, 255)
    box.Font = Enum.Font.SourceSans
    box.TextSize = 14
    
    local corner = Instance.new("UICorner", box)
    corner.CornerRadius = UDim.new(0, 10)

    box.FocusLost:Connect(function(enterPressed)
        if enterPressed then
            callback(box.Text)
        end
    end)
    
    return box
end

function UILib:destroy()
    self.gui:Destroy()
    setmetatable(self, nil)
end

return UILib
